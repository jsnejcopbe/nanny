/* SVN.committedRevision=1504173 */
Tips=function(b,c){var a=true;function d(){if(a){a=false;$(".pop_login-error").html(c);$(".pop_login-error").addClass("show");setTimeout(function(){a=true;$(".pop_login-error").removeClass("show")},2000)}}return{show:d}};define(["zepto","fastclick"],function(c,b){b.attach(document.body);var a={};a.init=function(){c("#back").on("click",function(){history.go(-1)});c("#fxback").on("click",function(){history.back()});c("#register_btn").on("click",function(){window.location=URLPrefix.passport+"/m/register_input.do"});c(".forgot_password").on("click",function(){window.location=URLPrefix.passport+"/m/find_pwd_input.do"});c("#register_fx_btn").on("click",function(){window.location=URLPrefix.passport+"/mfx/register_input.do?returnUrl="+c("#returnUrl").val()});c("#forgot_fx_password").on("click",function(){window.location=URLPrefix.passport+"/mfx/find_pwd_input.do"
});c(".pic_verification").on("click",refreshCaptcha);c(".icon-refresh").on("click",refreshCaptcha);c(".license-terms").on("click",function(){window.location="http://cms.yhd.com/cms/view.do?topicId=24883"});c("#login-btn").on("click",login);c("#login-btn-dis").on("click",login_dis);c(".icon-alipay").on("click",alipay);c(".icon-weibo").on("click",weibo);c(".icon-qq").on("click",qq);c(".icon-weixin").on("click",wechat);d("#touchweb_form-username");d("#touchweb_form-password");function d(f){var e=c(f);e.on("input",function(){var g=c(f).val().length;if(g>0){e.parent(".input_box").addClass("write")}else{e.parent(".input_box").removeClass("write")}})}c(".icon_delete").on("click",function(){c(this).siblings("input").val("").focus();c(this).parent(".input_box").removeClass("write")});c("#touchweb_form-username").on("blur",function(){var e=c(this).val();
agree(e)})};return a});function agree(c){var a={username:c};var b=URLPrefix.passport+"/passport/agree.do";$.post(b,a,function(d){if(d){if(d.show){$(".agreement").show()}else{$(".agreement").hide()}}})}function on_load(){var d=$("#touchweb_form-username");var c=$(".form_verification");var b=$(".pic_verification");var a=$(".icon_refresh");var f=getCookie("ac");if(f!=""){d.val(decodeURIComponent(f));$("#touchweb_form-password").focus();showValidCodeForH5Init(d.val(),c)}accountBlurIsShowValidCode(d,c,b,a);isShowValidCode();agree(d.val())}function on_load_for_fx(){var d=$("#touchweb_form-username");var c=$(".form_verification");var b=$(".pic_verification");var a=$(".icon_refresh");var f=getCookie("fx_ac");if(f!=""){d.val(decodeURIComponent(f));$("#touchweb_form-password").focus();showValidCodeForH5Init(d.val(),c)
}accountBlurIsShowValidCode(d,c,b,a);isShowValidCode();agree(d.val())}function on_load_for_vdian(){var d=$("#touchweb_form-username");var c=$(".form_verification");var b=$(".pic_verification");var a=$(".icon_refresh");var f=getCookie("ac");if(f!=""){d.val(decodeURIComponent(f));showValidCodeForH5Init(d.val(),c)}accountBlurIsShowValidCode(d,c,b,a);isShowValidCode();agree(d.val())}function getCookie(c){var d=document.cookie.split(";");for(var b=0;b<d.length;b++){var a=d[b].split("=");if(a[0].replace(/(^\s*)|(\s*$)/g,"")==c){return a[1]}}return""}function showValidCodeForH5Init(d,c){var a={"credentials.username":d};var b=URLPrefix.passport+"/publicPassport/showValidate.do";$.ajax({type:"post",url:b,data:a,success:function(e){if(e){if(e.ShowValidCode==1){refreshCaptcha();c.removeClass("none");$("#register_form-phone-verification").val("")
}else{c.addClass("none")}}}})}function accountBlurIsShowValidCode(c,e,d,b){var f=c.val();var a=true;c.blur(function(){if(showValidCode!=1&&c.val()&&(c.val()!=f||(a&&e.hasClass("none")))){f=c.val();a=false;var g={"credentials.username":c.val()};var h=URLPrefix.passport+"/publicPassport/showValidate.do";$.ajax({type:"post",url:h,data:g,success:function(i){if(i){if(i.ShowValidCode==1){refreshCaptcha();e.removeClass("none");$("#register_form-phone-verification").val("")}else{e.addClass("none")}}}})}})}function isShowValidCode(){if(showValidCode==1){refreshCaptcha();$(".form_verification").removeClass("none");$("#register_form-phone-verification").val("")}}function refreshCaptcha(){if(valid_code_service_flag==1){Captcha.setMode("remote")}Captcha.load(".pic_verification")}function stringTrim(a){return a.replace(/(^\s*)|(\s*$)/g,"")
}function stringLen(b){b=stringTrim(b);var a=0;if(b){a=b.replace(/[^\x00-\xff]/g,"***").length}return a}function checkAccount_beforeLogin(b){if(b==""){var a=new Tips(undefined,"登录账号不能为空");a.show();return false}else{if(stringLen(b)>100){var a=new Tips(undefined,"账号长度不能超过100位");a.show();return false}else{if(b.toLowerCase().indexOf("<script")>-1||b.toLowerCase().indexOf("<\/script")>-1){var a=new Tips(undefined,"账号中包含非法字符");a.show();return false}}}return true}function checkPwd_beforeLogin(c){var b=/\s+/;if(c==""){var a=new Tips(undefined,"密码不能为空");a.show();return false}else{if(b.test(c)){var a=new Tips(undefined,"密码不能有空格");a.show();return false}}return true}function checkValidCode_beforeLogin(b){var c=$(".form_verification");if(c.hasClass("none")){return true}if($("#register_form-phone-verification").val()==""){var a=new Tips(undefined,"请输入校验码");
a.show();return false}return true}function showAgreeNewContract(e,g,d,f){var b="";b=URLPrefix.passport;var c=encodeURIComponent(g);var a=b+"/m/legal/showNewContract.do?random="+e+"&returnUrl="+c+"&isAutoLogin="+f;if(d){a=d+"?result="+LOGIN_RESULT.FAIL+"&exceptionUrl="+encodeURIComponent(a)}window.location=a}function button_recover(){$("#login-btn").text("登录");$("#login-btn").on("click",login)}function login(){$("#login-btn").text("登录中...");$("#login-btn").off("click");var c=$("#touchweb_form-username").val();var h=$("#touchweb_form-password").val();var g=$("#register_form-phone-verification").val();var j=$("#touchweb_form-checkbox").attr("checked");if(!checkAccount_beforeLogin(c)){button_recover();return false}if(!checkPwd_beforeLogin(h)){button_recover();return false}if(!checkValidCode_beforeLogin(g)){button_recover();
return false}var d=0;if(j){d=1}var f=new JSEncrypt();f.setPublicKey(pubkey);c=f.encrypt(c);h=f.encrypt(h);var i="";var e=document.getElementById("__yct_str__");if(null!=e){i=e.value}var b={"credentials.username":c,"credentials.password":h,validCode:g,sig:$("#validateSig").val(),captchaToken:i,loginSource:1,returnUrl:returnUrl,isAutoLogin:d};var a=URLPrefix.passport+"/m/login.do";$.ajax({type:"post",url:a,data:b,success:function(l){if(l){if(l.errorCode!=0){if(l.ShowValidCode==1){refreshCaptcha();$(".form_verification").removeClass("none")}if(l.errorCode==1){var k=new Tips(undefined,"账号不能为空");k.show()}else{if(l.errorCode==2){var k=new Tips(undefined,"密码不能为空");k.show()}else{if(l.errorCode==4){var k=new Tips(undefined,"请重新登录");k.show()}else{if(l.errorCode==5){window.location.href="/m/goToPage.do"
}else{if(l.errorCode==7){var k=new Tips(undefined,"账号和密码不匹配，请重新输入");k.show()}else{if(l.errorCode==9){var k=new Tips(undefined,"密码错误");k.show()}else{if(l.errorCode==10){var k=new Tips(undefined,"验证码错误，请重新输入");k.show()}else{if(l.errorCode==11||l.errorCode==30){var k=new Tips(undefined,"请输入验证码");k.show()}else{if(l.errorCode==13){var k=new Tips(undefined,"您的账号有安全风险已冻结，请致电400-007-1111解冻");k.show()}else{if(l.errorCode==14){var k=new Tips(undefined,"登录异常，请输入验证码");k.show()}else{if(l.errorCode==29||l.errorCode==31||l.errorCode==33){$("#to_update_password").bind("click",function(){window.location.href="http://m.yhd.com/myH5/h5changePassword/h5ChangePassword.do"});$("#to_ignore_to_update_password").bind("click",function(){window.location.href=l.returnUrl});$("#pop").show()}else{if(l.errorCode==15){var k=new Tips(undefined,"登录异常，请重新登录");
k.show()}else{if(l.errorCode==16){window.location.href="/m/toSafeNoticFrom.do"}else{if(l.errorCode==17){var k=new Tips(undefined,"您的账户异常，预计1个工作日内处理完毕");k.show()}else{if(l.errorCode==18){var k=new Tips(undefined,"密码错还可试2次");k.show()}else{if(l.errorCode==19){var k=new Tips(undefined,"密码错还可试1次");k.show()}else{if(l.errorCode==20){window.location.href="/m/goToPage.do"}else{if(l.errorCode==24){var k=new Tips(undefined,"登录异常，请重新登录");k.show()}else{if(l.errorCode==26){var k=new Tips(undefined,"登录异常，请重新登录");k.show()}}}}}}}}}}}}}}}}}}}button_recover()}else{if(l.errorCode==0){window.location.href=l.returnUrl}}}}})}function button_recover_dis(){$("#login-btn-dis").text("登录");$("#login-btn-dis").on("click",login_dis)}function login_dis(){$("#login-btn-dis").text("登录中...");$("#login-btn-dis").off("click");
var c=$("#touchweb_form-username").val();var h=$("#touchweb_form-password").val();var g=$("#register_form-phone-verification").val();var j=$("#touchweb_form-checkbox").attr("checked");if(!checkAccount_beforeLogin(c)){button_recover_dis();return false}if(!checkPwd_beforeLogin(h)){button_recover_dis();return false}if(!checkValidCode_beforeLogin(g)){button_recover_dis();return false}var d=0;if(j){d=1}var f=new JSEncrypt();f.setPublicKey(pubkey);c=f.encrypt(c);h=f.encrypt(h);var i="";var e=document.getElementById("__yct_str__");if(null!=e){i=e.value}var b={"credentials.username":c,"credentials.password":h,validCode:g,sig:$("#validateSig").val(),captchaToken:i,loginSource:1,returnUrl:returnUrl,isAutoLogin:d};var a=URLPrefix.passport+"/mfx/login.do";$.ajax({type:"post",url:a,data:b,success:function(l){if(l){if(l.errorCode!=0){if(l.ShowValidCode==1){refreshCaptcha();
$(".form_verification").removeClass("none")}if(l.errorCode==1){var k=new Tips(undefined,"账号不能为空");k.show()}else{if(l.errorCode==2){var k=new Tips(undefined,"密码不能为空");k.show()}else{if(l.errorCode==4){var k=new Tips(undefined,"登录异常，请重新登录");k.show()}else{if(l.errorCode==5){var k=new Tips(undefined,"登录失败次数过多，请过15分钟后重新登录");k.show()}else{if(l.errorCode==7){var k=new Tips(undefined,"账号和密码不匹配，请重新输入");k.show()}else{if(l.errorCode==9){var k=new Tips(undefined,"密码错误");k.show()}else{if(l.errorCode==10){var k=new Tips(undefined,"验证码错误，请重新输入");k.show()}else{if(l.errorCode==11||l.errorCode==30){var k=new Tips(undefined,"登录异常，请输入验证码");k.show()}else{if(l.errorCode==13){var k=new Tips(undefined,"您的账号有安全风险已冻结，请致电400-007-1111解冻");k.show()}else{if(l.errorCode==14){var k=new Tips(undefined,"登录异常，请输入验证码");k.show()
}else{if(l.errorCode==29||l.errorCode==31||l.errorCode==33){window.location.href=l.returnUrl}else{if(l.errorCode==15){var k=new Tips(undefined,"登录异常，请重新登录");k.show()}else{if(l.errorCode==16){var k=new Tips(undefined,"您的账户存在安全风险，请先修改密码");k.show()}else{if(l.errorCode==17){var k=new Tips(undefined,"您的账户异常，预计1个工作日内处理完毕");k.show()}else{if(l.errorCode==18){var k=new Tips(undefined,"密码错还可试2次");k.show()}else{if(l.errorCode==19){var k=new Tips(undefined,"密码错还可试1次");k.show()}else{if(l.errorCode==20){var k=new Tips(undefined,"登录失败次数过多，请过60分钟后重新登录");k.show()}else{if(l.errorCode==24){var k=new Tips(undefined,"登录异常，请重新登录");k.show()}else{if(l.errorCode==26){var k=new Tips(undefined,"登录异常，请重新登录");k.show()}}}}}}}}}}}}}}}}}}}button_recover_dis()}else{if(l.errorCode==0){window.location.href=l.returnUrl}}}}})}function qq(){window.location.href=URLPrefix.passport+"/m/qq/login.do"
}function weibo(){window.location.href=URLPrefix.passport+"/m/sina/login.do"}function alipay(){window.location.href=URLPrefix.passport+"/m/alipay/login.do"}function wechat(){window.location.href=URLPrefix.passport+"/m/wechat/login.do"};Captcha={mode:"remote",url0:"/passport/valid_code.do",url:"https://captcha.yhd.com/public/getjpg.do",getCaptchaUrl:function(){if(this.mode=="remote"){return this.url}return this.url0},load:function(d){var f=$(d);var e=this.getCaptchaUrl();if(f){if(e==this.url){getValidateSigAndSetImageSrc(f)}else{f.attr("src",e+"?t="+Math.random())}}},url2:"/m/mSendCheckCodeForRegister.do",url3:"/passport/sendMobileCheckCode.do",url4:"/passport/sendCheckCodeForRegister.do",url5:"/validator/send.do",url6:"/validator/sendWithoutCheck.do",sendMobileCaptchaWithParam:function(g,e,f,h){$.ajax({type:"POST",url:g,data:e,async:false,success:function(b){if(b){if(b.errorCode!=0){var a=b.errorCode;h.apply(this,[a]);return}f.apply(this,[b.errorCode])}}})},sendMobileCaptcha:function(f,h,e,g){$.ajax({type:"POST",url:f,async:false,success:function(b){if(b){if(b.errorCode!=0){var a=b.errorCode;
g.apply(this,[a]);return}e.apply(this,[b.errorCode])}}})},send:function(e,f,d){this.sendMobileCaptcha(this.url2,e,f,d)},setMode:function(b){this.mode=b}};function getValidateSigAndSetImageSrc(b){$.ajax({type:"GET",dataType:"jsonp",jsonp:"callback",url:"https://captcha.yhd.com/public/getsig.do?t="+Math.random(),success:function(a){var e=a.sig;$("#validateSig").val(e);var f="https://captcha.yhd.com/public/getjpg.do?sig="+e;b.attr("src",f)}})}ValidatorProvider={};ValidatorProvider.onBlur=function(f,e){var d=jQuery("#vcd").val();if(d==""){jQuery("#code_right").hide();jQuery("#code_wrong").show();showErrorInfo($("#vcd"),"请输入校验码")}else{if(d.length!=4){jQuery("#code_right").hide();jQuery("#code_wrong").show();showErrorInfo($("#vcd"),"验证码格式不正确")}}};ValidatorProvider.setValidateUrl=function(b){this["validateUrl"]=b
};ValidatorProvider.success=function(b){};ValidatorProvider.fail=function(b){};ValidatorProvider.error=function(b){};ValidatorProvider.onValidate=function(){var c=$("#vcd").val();if(c.length!=4){jQuery("#code_right").hide();jQuery("#code_wrong").show();showErrorInfo($("#vcd"),"验证码格式不正确");return}var d={validCode:c};jQuery.post(this["validateUrl"],d,function(a){if(a){if(a.errorCode!=0){if(a.errorCode==2){jQuery("#code_right").hide();jQuery("#code_wrong").show();if(a.refresh){if(a.refresh==1){passport_refresh_valid_code()}}showErrorInfo($("#vcd"),"验证码错误，请重新输入")}}else{jQuery("#code_right").show();jQuery("#code_wrong").hide();clearErrorInfo()}}else{jQuery("#code_right").hide();jQuery("#code_wrong").show();clearErrorInfo()}})};Validator={};Validator.registerValidatorProvider=function(){};